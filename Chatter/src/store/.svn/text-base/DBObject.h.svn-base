//
//  DBObject.h
//  Get
//
//  Created by Curtis Jones on 2010.03.11.
//  Copyright 2010 Nexidia. All rights reserved.
//

#import <Cocoa/Cocoa.h>

#define CZ_DBOBJ_ERROR(s,r,d) {                                           \
  NSLog(@"%s.. [%@] failed to exec", __PRETTY_FUNCTION__, (s)->mName);    \
  [(s) dump];                                                             \
  r = FALSE;                                                              \
  goto d;                                                                 \
}

#define CZ_DBOBJ_HANDLE(constructor, selector) {                          \
  while (![result isDone]) {                                              \
    object = constructor;                                                 \
    [object __dbobjectHandleResult:result];                               \
    [object setDocument:document];                                        \
    [document performSelector:selector withObject:[object dbobjectCopy]]; \
    [objects addObject:object];                                           \
    [result next];                                                        \
  }                                                                       \
}

extern NSString * const CZExceptionNoDbConnection;
extern NSString * const CZExceptionNoStatement;
extern NSString * const CZExceptionDbAlreadyConnected;
extern NSString * const CZExceptionIllegalOperation;

typedef enum
{
	DBObjectComparisonEquals = 1,
	DBObjectComparisonNotEquals = 2
} DBObjectComparisonResult;





@protocol DBObject

/**
 *
 */
- (DBObjectComparisonResult)dbobjectCompare:(id<DBObject>)anObject;

/**
 *
 */
- (id<DBObject>)dbobjectCopy;

/**
 *
 */
- (BOOL)dbobjectInsert;

/**
 *
 */
- (BOOL)dbobjectUpdate;

/**
 *
 */
- (BOOL)dbobjectDelete;

@end





@interface DBObject : NSObject

@end
